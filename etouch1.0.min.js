(function(a,h){function e(j,i,l,k){return Math.abs(j-i)>=Math.abs(l-k)?(j-i>0?"left":"right"):(l-k>0?"up":"down")}function f(n,m,j,l){if(typeof j!="string"){for(var k=0;k<n.length;k++){n[k].addEventListener(m,l,false)}return}n[0].addEventListener(m,function(q){var r=q.target;var i=q.currentTarget;var p=true;while(p&&r!=i){if(o(n,j,r)){p=l.call(r,q)}r=r.parentNode}return p},false);function o(s,p,t){var q=s[0].querySelectorAll(p);for(var r=0;r<q.length;r++){if(q[r]==t){return true}}}}function c(j,i,k){this.root=document.querySelectorAll(j);this.target=null;if(!this.root){console.log("root不存在");return}this.touchObj={status:"",pageX:0,pageY:0,clientX:0,clientY:0,distanceX:0,distanceY:0,};this.isTap=false;this.time=0;this.selector=i;this.Event=[];if(arguments[2]==h){this.operate(arguments[1])}else{this.operate(arguments[2])}}c.prototype.init=function(){this.touchObj.distanceX=0;this.touchObj.distanceY=0};c.prototype.operate=function(i){var j=this.touchObj,k=this.isTap,l=this;f(this.root,"touchstart",this.selector,function(m){l.target=this;d(m,j,l)});f(this.root,"touchmove",this.selector,function(m){g(m,this,j,l)});f(this.root,"touchend",this.selector,function(m){b(m,this,j,l,i)});return this};c.prototype.trigger=function(l,m){var j=this.touchObj.status;for(var k=0;k<this.Event.length;k++){if(this.Event[k].type==l){this.Event[k].method.call(this.target,m,this.touchObj)}}return this};c.prototype.on=function(j,i){this.Event.push({type:j,method:i});return this};function d(k,j,i){i.init();var l=k.touches[0];j.pageX=l.pageX;j.pageY=l.pageY;j.clientX=l.clientX;j.clientY=l.clientY;i.time=+new Date()}function g(k,m,j,i){var l=k.touches[0];j.status="swiper";j.distanceX=l.pageX-j.pageX;j.distanceY=l.pageY-j.pageY;if(j.status=="swiper"&&Math.abs(j.distanceY/j.distanceX)<1.2){k.preventDefault();i.trigger(j.status,k,j)}}function b(o,k,r,n,q){var m=o.changedTouches[0];var l=+new Date()-n.time;r.distanceX=m.pageX-r.pageX;r.distanceY=m.pageY-r.pageY;var j=r.pageX;var i=r.pageX+r.distanceX;var s=r.pageY;var p=r.pageY+r.distanceY;r.status=e(j,i,s,p);if(l<150&&Math.abs(r.distanceX)<2&&Math.abs(r.distanceY)<2){n.isTap=true;if(n.isTap){r.status="tap";setTimeout(function(){n.isTap=false;q.call(k,o,r)},30)}}else{n.trigger(r.status,o,r)}}if(typeof define==="function"&&(define.amd||define.cmd)){define(function(){return c(root,selector,fn)})}else{a.etouch=function(j,i,k){return new c(j,i,k)}}})(window,undefined);
